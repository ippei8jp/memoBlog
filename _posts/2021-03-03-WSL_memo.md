---
title: WSL2 メモ
date: 2021-03-03
tags: ["WSL"]
excerpt: WSL2に関するメモ
layout: default
---

# インストール
## WSL2のインストール 
参考： [WSL2をインストールしてみた](https://itengine.seesaa.net/article/479688577.html){:target="_blank"}

## Virtualboxとの共存 
参考： [Vagrant + Virtualbox 6.1.16 と WSL2 を同時に動かしたメモ](https://qiita.com/hibohiboo/items/c17459e0af84d2059d21){:target="_blank"}

# セットアップ

## アップデート
```bash
sudo apt update
sudo apt upgrade 
```

## 日本語化
```bash
# 日本語ランゲージパック
sudo apt -y install language-pack-ja
# ロケールの設定
sudo update-locale LANG=ja_JP.UTF8
# 日本語manページのインストール
sudo apt -y install manpages-ja manpages-ja-dev
```

## BEEPを消す
鬱陶しいのでBEEPを消しておく。  
参考： [Bash on Windowsでビープ音を消す方法](https://linuxfan.info/bow-stop-beep){:target="_blank"}

- ターミナルのbeepを消して画面フラッシュにする
```bash
echo "set bell-style visible" >> ~/.inputrc
```
- vimのbeepを消す
```bash
echo "set visualbell t_vb=" >> ~/.vimrc
```

## デフォルトshをbashに変更
```bash
cd /bin
sudo ln -sf bash sh
```
## ツール類インストール
```bash
sudo apt install net-tools
```

## 作業ディレクトリの作成
```bash
sudo mkdir /proj /work
sudo chown `whoami`:`whoami` /proj /work
```

## pyenvのインストール
参考：[pyenvのインストール]({{ site.baseurl }}/2019/06/27/pyenv.html){:target="_blank"}

## nodenvのインストール
参考：[nodenvのインストール]({{ site.baseurl }}/2019/06/28/nodenv.html){:target="_blank"}


## .bashrcの設定
```bash
# プロンプトの設定
PS1="\w\$ "

# キーバインドの設定
bind '"\C-n": history-search-forward'
bind '"\C-p": history-search-backward'

# ディレクトリスタックの表示改善
function pushd() {
    command pushd $* > /dev/null
        command dirs -v
}
function popd() {
    command popd $* > /dev/null
        command dirs -v
}
function dirs() {
    command dirs -v
}

# 表示色変更
export LS_COLORS='di=01;32:ln=01;36:ex=01;31:'
export GREP_COLORS='mt=01;31:ml=:cx=:fn=01;32:ln=32:bn=32:se=36'

# lessのオプション
export LESS="-iMR"

# for pyenv
export PYENV_ROOT=/proj/.pyenv    #環境に合わせて修正してね
if [ -e $PYENV_ROOT ]; then
    export PATH=$PYENV_ROOT/bin:$PATH
    # 仮想環境名をプロンプトに表示しない場合は以下を有効化
    export VIRTUAL_ENV_DISABLE_PROMPT=1
    eval "$(pyenv init -)"
    eval "$(pyenv virtualenv-init -)"
    export PYTHON_CONFIGURE_OPTS="\
     --enable-shared\
    "
fi

# for nodenv
export NODENV_ROOT=/proj/.nodenv    # 環境に合わせて修正してね
if [ -e $NODENV_ROOT ]; then
    export PATH=$NODENV_ROOT/bin:$PATH
    eval "$(nodenv init -)"
fi
```



# GUIアプリを使用する
参考： [WSL2でGUIアプリを起動](https://qiita.com/vega77/items/f00323e8ce64bfa1fdd6){:target="_blank"}


# WSL2上のサーバプログラムへのアクセス
参考：[Linuxがほぼそのまま動くようになった「WSL2」のネットワーク機能](https://www.atmarkit.co.jp/ait/articles/1909/09/news020.html){:target="_blank"}  

| 向き        |  可否                                   |
| ----------- | --------------------------------------- |
|HOST → WSL2 | localhost でアクセスできる              |
|WSL2 → HOST | localhost でアクセスできない。<BR> IPアドレス指定ならアクセスできる。      |

# なんかのときに使うかも  

試してないけど、メモっておく。  

- 同一ディストリビューションの複製  
[WSL 上で同一ディストリビューションの環境を複数インストール･管理する](https://qiita.com/souyakuchan/items/9f95043cf9c4eda2e1cc){:target="_blank"}

- 仮想環境をCドライブ以外に変更する  
[[Windows] Docker Desktop の ディスク領域 を Cドライブから別のドライブへ移動する方法](https://nosubject.io/windowsdocker-desktop-move-disk-image/){:target="_blank"}

- 仮想ディスクが肥大化した場合の対処方法  
[WSL2を使っているパソコンのディスク容量が枯渇したときにやってみるべきこと](https://qiita.com/386jp/items/e469333c5a74789db46d){:target="_blank"}

